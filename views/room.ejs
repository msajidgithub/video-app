<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
   <link rel="stylesheet" href="style.css">
  <script src="https://kit.fontawesome.com/c939d0e917.js"></script>
  <!-- Include from the CDN -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.5/dist/html2canvas.min.js"></script>
  <script defer src="https://unpkg.com/peerjs@1.2.0/dist/peerjs.min.js"></script>
  <script src="Blob.js"></script>
  <script src="FileServer.js"></script>
  <script src="/socket.io/socket.io.js" defer></script>
  <script src="script.js" defer></script>
  <title>Zoom Clone</title>

  
  <script>
    const ROOM_ID = "<%= roomId %>"


  </script>
</head>
<body>
  <div class="main">
    <div class="main__left">
      <div id="video-grid" class="main__videos"></div>
      <div id="img-grid"></div>
      <div class="main__controls">
        <div class="main__controls__block">
          <div onclick="muteUnmute()" class="main__controls__button main__mute_button">
              <i class="fas fa-microphone" aria-hidden="true"></i>
              <span>Mute</span>
          </div>
          <div onclick="playStop()" class="main__controls__button main__video_button">
              <i class="fas fa-video" aria-hidden="true"></i>
              <span>Stop Video</span>
          </div>
        </div>
        <div class="main__controls__block">
          <div onclick="shoot()" class="main__controls__button">
              <i class="fas fa-camera" aria-hidden="true"></i>
              <span>Screen Capture</span>
          </div>
        </div>
        <div class="main__controls__block">
          
        </div>
      </div>

    </div>
  </div>
    <!-- Define the button 
    that will be used to 
    take the screenshot -->
    <!-- <div class="output"></div> -->
    <canvas id="canvas" style="display: none;"></canvas>

    <!-- <button id="snap" onclick="shoot()">Take screenshot</button> -->

  </body>

		<script type="text/javascript">

    var scaleFactor = 0.25;

   


    

    function capture(video, scaleFactor) {
        if (scaleFactor == null) {
            scaleFactor = 1;
        }
        var w = video.videoWidth * scaleFactor;
        var h = video.videoHeight * scaleFactor;
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0, w, h);
    }

    function shoot() {
        var video = document.getElementsByTagName('video')[0];
        var output = document.getElementById('img-grid');


        capture(video, scaleFactor);
        convertCanvasToImage();
    }


  		function snap() {
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0 ,100, 100);
      }

      function convertCanvasToImage() {
        
        let canvas = document.getElementById("canvas");
        let image = new Image(600,900);
        image.width = 1000;
        image.height = 1000;
        image.src = canvas.toDataURL();
        image.id = "img-id";
        if(document.getElementById("img-id") != null){
          document.getElementById("img-id").remove();
        }
        document.getElementById("img-grid").appendChild(image);
        createImage(canvas);
      }


      
	</script>

</html>
